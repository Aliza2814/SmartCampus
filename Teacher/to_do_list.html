<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List - SmartCampus Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="to_do_list.css">
</head>

<body>
    <div class="app">
        <aside class="sidebar">
            <div class="brand">
                <div class="logo"><img src="../img1.png"></div>
                <div>SmartCampus</div>
            </div>
            <nav class="nav">
                <a href="../index.html">🏠 Dashboard</a>
                <a href="myvault.html">📂 MyVault</a>
                <a href="comps_std.html">📢 Complaints</a>
                <a href="lost_found.html">🔎 Lost & Found</a>
                <a href="student-attendance.html">📅 Attendance</a>
                <a href="to_do_list.html" class="active">📝 To-Do</a>
                <a href="../index.html#calendarSection">🗓️ Calendar</a>
            </nav>
            <!-- <div class="tools">
                <button class="tool-btn" id="toggleTheme"> Toggle Dark</button>
                <button class="tool-btn" id="openDrawer"> Notifications</button>
            </div> -->
        </aside>

        <main>
            <header class="topbar">
                <div class="topbar-inner">
                    <div class="search" style="min-width:260px;">
                        🔎 <input id="search" placeholder="Search features, files, events... " />
                    </div>
                    <div class="user-profile">AS</div>
                </div>
            </header>

            <div class="container">
                <div class="title-section">
                    <h2>My To-Do List</h2>
                    <p>Organize your tasks, stay on track, and boost your productivity.</p>
                </div>

                <div class="panel">
                    <form class="add-task-form">
                        <div class="form-group" style="flex-grow: 2;">
                            <label for="task-title">Task Name</label>
                            <input type="text" id="task-title" placeholder="e.g., Complete Physics homework">
                        </div>
                        <div class="form-group">
                            <label for="task-category">Category</label>
                            <select id="task-category">
                                <option value="academic">Academic</option>
                                <option value="personal">Personal</option>
                                <option value="club">Club Activity</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="task-due-date">Due Date</label>
                            <input type="date" id="task-due-date" value="2025-09-06">
                        </div>
                        <button type="submit" class="btn btn-primary">Add Task</button>
                    </form>
                </div>

                <div class="controls">
                    <div class="filter-bar">
                        <button class="filter-btn active">All</button>
                        <button class="filter-btn">Pending</button>
                        <button class="filter-btn">Completed</button>
                    </div>
                </div>

                <div class="panel">
    <ul class="task-list">
        </ul>
</div>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const taskForm = document.querySelector('.add-task-form');
            const taskTitleInput = document.getElementById('task-title');
            const taskCategoryInput = document.getElementById('task-category');
            const taskDateInput = document.getElementById('task-due-date');
            const taskList = document.querySelector('.task-list');
            const filterBar = document.querySelector('.filter-bar');

            // Load tasks from localStorage or start with an empty array
            let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
            let currentFilter = 'all';

            // Function to save tasks to localStorage
            const saveTasks = () => {
                localStorage.setItem('tasks', JSON.stringify(tasks));
            };

            // Main function to render all tasks
            const renderTasks = () => {
                taskList.innerHTML = ''; // Clear the list

                // Filter tasks based on the current filter
                const tasksToRender = tasks.filter(task => {
                    if (currentFilter === 'pending') return !task.completed;
                    if (currentFilter === 'completed') return task.completed;
                    return true; // 'all'
                });

                if (tasksToRender.length === 0) {
                    taskList.innerHTML = '<li class="empty-message">No tasks to show.</li>';
                }

                tasksToRender.forEach(task => {
                    const li = document.createElement('li');
                    li.className = task.completed ? 'completed' : '';
                    li.dataset.id = task.id;

                    li.innerHTML = `
                        <div class="task-item">
                            <div class="task-check"><input type="checkbox" ${task.completed ? 'checked' : ''}></div>
                            <div class="task-details">
                                <div class="task-title">${task.title}</div>
                                <div class="task-meta">
                                    <span class="tag tag-${task.category}">${task.category}</span>
                                    <span>Due: ${task.dueDate || 'No date'}</span>
                                </div>
                            </div>
                            <div class="task-actions">
                                <button class="action-btn" title="Edit">
                                    <i class="fa-solid fa-pencil"></i>
                                </button>
                                <button class="action-btn" title="Delete">
                                    <i class="fa-solid fa-trash-can"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    taskList.appendChild(li);
                });
            };

            // Event: Add a new task
            taskForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const title = taskTitleInput.value.trim();
                if (!title) return; // Don't add empty tasks

                const newTask = {
                    id: Date.now(),
                    title: title,
                    category: taskCategoryInput.value,
                    dueDate: taskDateInput.value,
                    completed: false
                };

                tasks.push(newTask);
                saveTasks();
                renderTasks();
                taskForm.reset();
            });

            // Event: Handle clicks on the task list (complete, edit, delete)
            taskList.addEventListener('click', (e) => {
                const li = e.target.closest('li[data-id]');
                if (!li) return;
                
                const taskId = Number(li.dataset.id);
                const task = tasks.find(t => t.id === taskId);

                // Toggle complete
                if (e.target.matches('input[type="checkbox"]')) {
                    task.completed = e.target.checked;
                    li.classList.toggle('completed', task.completed);
                    if (currentFilter !== 'all') renderTasks(); // Re-render if filtered
                }
                
                // Delete task
                if (e.target.closest('.action-btn[title="Delete"]')) {
                    tasks = tasks.filter(t => t.id !== taskId);
                    li.remove();
                }

                // Edit task
                if (e.target.closest('.action-btn[title="Edit"]')) {
                    const newTitle = prompt('Edit task:', task.title);
                    if (newTitle && newTitle.trim()) {
                        task.title = newTitle.trim();
                        li.querySelector('.task-title').textContent = task.title;
                    }
                }
                
                saveTasks(); // Save changes for all actions
            });

            // Event: Handle filter button clicks
            filterBar.addEventListener('click', (e) => {
                const btn = e.target.closest('.filter-btn');
                if (!btn) return;

                filterBar.querySelector('.active').classList.remove('active');
                btn.classList.add('active');
                currentFilter = btn.textContent.toLowerCase();
                renderTasks();
            });

            // Initial render on page load
            renderTasks();
        });
    </script>
    
</body>

</html>
